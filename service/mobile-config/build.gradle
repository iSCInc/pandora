version = "0.1.19-SNAPSHOT"
apply from: rootProject.file('gradle/dropwizard_service.gradle')
mainClassName = "com.wikia.mobileconfig.MobileConfigApplication"
def consulMobileConfigSourceUrl = "http://localhost:8500/config/mobile-config/"
def prodStage = "prod"
def testingStage = "testing"
def qaStage = "qa"

applicationDefaultJvmArgs = [
        "-Xms100m", "-Xmn128m", "-Xmx300m", "-XX:+UseNUMA", "-XX:+UseCondCardMark", "-XX:+UseBiasedLocking", "-XX:+UseConcMarkSweepGC", "-XX:+UseParNewGC"
]

dependencies {
    compile project(":lib:service-core")
    testCompile project(path: ':lib:service-core', configuration: 'tests')
}

deployments {
    production {
        resources {
            cpus = 1
            mem = 400
            instances = 2
        }
        environment {
            MOBILE_CONFIG_SERVICE_STAGE = prodStage
            CONSUL_KEY_VALUE_CONFIG_SOURCE = consulMobileConfigSourceUrl + prodStage
        }
    }
    testing {
        environment {
            MOBILE_CONFIG_SERVICE_STAGE = testingStage
            CONSUL_KEY_VALUE_CONFIG_SOURCE = consulMobileConfigSourceUrl + testingStage
        }
    }

    qa {
        resources {
            cpus = 0.1
            mem = 400
            instances = 1
        }
        environment {
            MOBILE_CONFIG_SERVICE_STAGE = qaStage
            CONSUL_KEY_VALUE_CONFIG_SOURCE = consulMobileConfigSourceUrl + qaStage
        }
    }
}
